{"ast":null,"code":"var _jsxFileName = \"/Users/lucassjostrommacbook/collected-calendar-build/src/components/DataCollection/ReqUsers.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { useState, useEffect } from \"react\";\nimport { loginRequest } from '../../AuthenticationFolder/authConfig';\nimport Button from \"react-bootstrap/Button\";\nimport { callForUser, callForNextUser } from \"./GraphCalls\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction handleLogin(instance) {\n  //Handles login and catches exceptions\n  instance.loginRedirect(loginRequest).catch(e => {\n    console.error(e);\n  });\n}\n\nfunction handleLogout(instance) {\n  //Handles login and catches exceptions\n  instance.logoutRedirect().catch(e => {\n    console.error(e);\n  });\n}\n\nfunction GetUsers() {\n  _s();\n\n  const {\n    instance,\n    accounts\n  } = useMsal();\n  const [userList, setUserList] = useState([]);\n  const userArr = [];\n  const name = accounts[0] && accounts[0].name;\n\n  function RequestUsers() {\n    setUserList(null);\n    console.log(userList);\n    const request = { ...loginRequest,\n      account: accounts[0]\n    }; //It checks for a authentication token, on the instance silently.\n\n    instance.acquireTokenSilent(request).then(response => {\n      callForUser(response.accessToken).then(response => setUserList(response));\n    }).catch(e => {\n      //If there is no token to be found, it will try to retrieve one in the background.\n      instance.acquireTokenPopup(request).then(response => {\n        callForUser(response.accessToken).then(response => setUserList(response));\n      });\n    });\n    userList.value.forEach(element => {\n      userArr.push(element.displayName);\n    }); //we'll check for the nextLink property.\n\n    if (\"@odata.nextLink\" in userList) {\n      console.log(\"more data is available!\");\n      instance.acquireTokenSilent(request).then(response => {\n        callForNextUser(response.accessToken, userList['@odata.nextLink']).then(response => setUserList(response));\n      });\n    }\n\n    if (\"@odata.nextLink\" in userList) {\n      console.log('Even more data is available!');\n      instance.acquireTokenSilent(request).then(response => {\n        callForNextUser(response.accessToken, userList['@odata.nextLink']).then(response => setUserList(response));\n      });\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [name, \" is logged in!\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => RequestUsers(),\n      children: \"Click me to retrieve data\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => handleLogout(instance),\n      children: \"Click me to logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n\n_s(GetUsers, \"sf2maGGYwB+cbN38WgznPl1HFFQ=\", false, function () {\n  return [useMsal];\n});\n\n_c = GetUsers;\nexport const ReqUsers = () => {\n  _s2();\n\n  //Bruger Msal (Microsfot Authentication Library.)\n  const {\n    instance\n  } = useMsal();\n  return (\n    /*#__PURE__*/\n    //Button class imported from react-boostrap\n    _jsxDEV(Button, {\n      className: \"ml-auto\",\n      onClick: () => handleLogin(instance),\n      children: \"Sign in using Redirect\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this)\n  );\n};\n\n_s2(ReqUsers, \"kNmaupTUyOO55c/HFAYpHUXUX7Y=\", false, function () {\n  return [useMsal];\n});\n\n_c2 = ReqUsers;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"GetUsers\");\n$RefreshReg$(_c2, \"ReqUsers\");","map":{"version":3,"names":["React","useMsal","useState","useEffect","loginRequest","Button","callForUser","callForNextUser","handleLogin","instance","loginRedirect","catch","e","console","error","handleLogout","logoutRedirect","GetUsers","accounts","userList","setUserList","userArr","name","RequestUsers","log","request","account","acquireTokenSilent","then","response","accessToken","acquireTokenPopup","value","forEach","element","push","displayName","ReqUsers"],"sources":["/Users/lucassjostrommacbook/collected-calendar-build/src/components/DataCollection/ReqUsers.jsx"],"sourcesContent":["import React from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { useState, useEffect } from \"react\"\nimport { loginRequest } from '../../AuthenticationFolder/authConfig'\nimport Button from \"react-bootstrap/Button\"\nimport { callForUser, callForNextUser } from \"./GraphCalls\"\n\nfunction handleLogin(instance) {\n    //Handles login and catches exceptions\n    instance.loginRedirect(loginRequest).catch(e => {\n        console.error(e);\n    });\n}\n\nfunction handleLogout(instance){\n    //Handles login and catches exceptions\n    instance.logoutRedirect().catch(e => {\n        console.error(e);\n    });\n}\n\n    function GetUsers(){\n    const { instance, accounts } = useMsal();\n    const [userList, setUserList] = useState([]);\n\n    const userArr = [];\n\n    const name = accounts[0] && accounts[0].name;\n\n    function RequestUsers(){\n\n        setUserList(null);\n        console.log(userList)\n        const request = {\n            ...loginRequest,\n            account: accounts[0]\n        }\n        //It checks for a authentication token, on the instance silently.\n        instance.acquireTokenSilent(request).then((response) => {\n            callForUser(response.accessToken).then(response => setUserList(response));\n        }).catch((e) => {\n            //If there is no token to be found, it will try to retrieve one in the background.\n            instance.acquireTokenPopup(request).then(response => {\n                callForUser(response.accessToken).then(response => setUserList(response))\n            })\n        })\n        userList.value.forEach(element => {\n            userArr.push(element.displayName)\n        });\n\n        //we'll check for the nextLink property.\n        if(\"@odata.nextLink\" in userList){\n            console.log(\"more data is available!\");\n            instance.acquireTokenSilent(request).then((response) => {\n                callForNextUser(response.accessToken, userList['@odata.nextLink']).then(response => setUserList(response));\n            }) \n        }\n\n        if(\"@odata.nextLink\" in userList){\n            console.log('Even more data is available!');\n            instance.acquireTokenSilent(request).then((response) => {\n                callForNextUser(response.accessToken, userList['@odata.nextLink']).then(response => setUserList(response));\n            }) \n        }            \n    }\n    return (\n        <>\n        <h2>{name} is logged in!</h2>\n        <button onClick={() => RequestUsers()}>Click me to retrieve data</button>\n        <button onClick={() => handleLogout(instance)}>Click me to logout</button>\n        </>\n    )\n}\n\n\n\nexport const ReqUsers = () => {\n    //Bruger Msal (Microsfot Authentication Library.)\n    const { instance } = useMsal();\n    return (\n        //Button class imported from react-boostrap\n        <Button className=\"ml-auto\" onClick={() => handleLogin(instance)}>Sign in using Redirect</Button>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}