{"ast":null,"code":"import { loginRequest } from '../../AuthenticationFolder/authConfig';\nimport { callForEvent } from './GraphCalls';\nexport async function GetEvent(data, instance, accounts) {\n  const request = { ...loginRequest,\n    account: accounts[0]\n  };\n  var tokenProm = instance.acquireTokenSilent(request).then(async res => {\n    return res.accessToken;\n  });\n  tokenProm = await tokenProm;\n  var usersSorted = data.value.map(user => {\n    if (user.accountEnabled === true && user.userPrincipalName.length < 13 && user.userPrincipalName.length > 10) {\n      return user;\n    }\n  });\n  usersSorted = usersSorted.filter(elem => {\n    return elem !== undefined;\n  });\n  var events = await Promise.all(usersSorted.map(user => {\n    return callForEvent(tokenProm, user.userPrincipalName).then(res => {\n      if (res.value !== undefined) {\n        return [res.value, user.displayName, user.department];\n      } else {\n        return [[], user.displayName, user.department];\n      }\n    });\n  }));\n  var bannedNames = [\"Jesper Nygaard Nilsen\", \"Finn Vedersø\", \"Scan-k32\", \"Scan-reception\", \"Scan-Risskov\"];\n  events = events.filter(elem => {\n    return !bannedNames.includes(elem[1]);\n  });\n  return events;\n}\n_c = GetEvent;\n\nvar _c;\n\n$RefreshReg$(_c, \"GetEvent\");","map":{"version":3,"names":["loginRequest","callForEvent","GetEvent","data","instance","accounts","request","account","tokenProm","acquireTokenSilent","then","res","accessToken","usersSorted","value","map","user","accountEnabled","userPrincipalName","length","filter","elem","undefined","events","Promise","all","displayName","department","bannedNames","includes"],"sources":["C:/Users/ljs/Desktop/calendar/src/components/DataCollection/GetEvent.jsx"],"sourcesContent":["import { loginRequest } from '../../AuthenticationFolder/authConfig'\r\nimport { callForEvent } from './GraphCalls';\r\n\r\nexport async function GetEvent (data, instance, accounts){\r\n  const request = {\r\n      ...loginRequest,\r\n      account: accounts[0]\r\n  };  \r\n\r\n  var tokenProm = instance.acquireTokenSilent(request).then(async (res) => {return res.accessToken});\r\n  tokenProm = await tokenProm;\r\n\r\n  var usersSorted = data.value.map((user) => {\r\n    if(user.accountEnabled === true && user.userPrincipalName.length < 13 && user.userPrincipalName.length > 10){\r\n      return user\r\n    }\r\n  })\r\n\r\n \r\n\r\n  usersSorted = usersSorted.filter((elem) => {return elem !== undefined})\r\n\r\n\r\n  var events = await Promise.all(usersSorted.map((user) => {\r\n    return callForEvent(tokenProm, user.userPrincipalName).then((res) => {\r\n      if(res.value !== undefined){\r\n        return [res.value, user.displayName, user.department]\r\n      }\r\n      else{\r\n        return [[], user.displayName, user.department]\r\n      }\r\n    })\r\n  }))\r\n\r\n  var bannedNames = [\"Jesper Nygaard Nilsen\", \"Finn Vedersø\", \"Scan-k32\", \"Scan-reception\", \"Scan-Risskov\"]\r\n\r\n  events = events.filter((elem) => {return !bannedNames.includes(elem[1])})\r\n  return events\r\n}\r\n"],"mappings":"AAAA,SAASA,YAAT,QAA6B,uCAA7B;AACA,SAASC,YAAT,QAA6B,cAA7B;AAEA,OAAO,eAAeC,QAAf,CAAyBC,IAAzB,EAA+BC,QAA/B,EAAyCC,QAAzC,EAAkD;EACvD,MAAMC,OAAO,GAAG,EACZ,GAAGN,YADS;IAEZO,OAAO,EAAEF,QAAQ,CAAC,CAAD;EAFL,CAAhB;EAKA,IAAIG,SAAS,GAAGJ,QAAQ,CAACK,kBAAT,CAA4BH,OAA5B,EAAqCI,IAArC,CAA0C,MAAOC,GAAP,IAAe;IAAC,OAAOA,GAAG,CAACC,WAAX;EAAuB,CAAjF,CAAhB;EACAJ,SAAS,GAAG,MAAMA,SAAlB;EAEA,IAAIK,WAAW,GAAGV,IAAI,CAACW,KAAL,CAAWC,GAAX,CAAgBC,IAAD,IAAU;IACzC,IAAGA,IAAI,CAACC,cAAL,KAAwB,IAAxB,IAAgCD,IAAI,CAACE,iBAAL,CAAuBC,MAAvB,GAAgC,EAAhE,IAAsEH,IAAI,CAACE,iBAAL,CAAuBC,MAAvB,GAAgC,EAAzG,EAA4G;MAC1G,OAAOH,IAAP;IACD;EACF,CAJiB,CAAlB;EAQAH,WAAW,GAAGA,WAAW,CAACO,MAAZ,CAAoBC,IAAD,IAAU;IAAC,OAAOA,IAAI,KAAKC,SAAhB;EAA0B,CAAxD,CAAd;EAGA,IAAIC,MAAM,GAAG,MAAMC,OAAO,CAACC,GAAR,CAAYZ,WAAW,CAACE,GAAZ,CAAiBC,IAAD,IAAU;IACvD,OAAOf,YAAY,CAACO,SAAD,EAAYQ,IAAI,CAACE,iBAAjB,CAAZ,CAAgDR,IAAhD,CAAsDC,GAAD,IAAS;MACnE,IAAGA,GAAG,CAACG,KAAJ,KAAcQ,SAAjB,EAA2B;QACzB,OAAO,CAACX,GAAG,CAACG,KAAL,EAAYE,IAAI,CAACU,WAAjB,EAA8BV,IAAI,CAACW,UAAnC,CAAP;MACD,CAFD,MAGI;QACF,OAAO,CAAC,EAAD,EAAKX,IAAI,CAACU,WAAV,EAAuBV,IAAI,CAACW,UAA5B,CAAP;MACD;IACF,CAPM,CAAP;EAQD,CAT8B,CAAZ,CAAnB;EAWA,IAAIC,WAAW,GAAG,CAAC,uBAAD,EAA0B,cAA1B,EAA0C,UAA1C,EAAsD,gBAAtD,EAAwE,cAAxE,CAAlB;EAEAL,MAAM,GAAGA,MAAM,CAACH,MAAP,CAAeC,IAAD,IAAU;IAAC,OAAO,CAACO,WAAW,CAACC,QAAZ,CAAqBR,IAAI,CAAC,CAAD,CAAzB,CAAR;EAAsC,CAA/D,CAAT;EACA,OAAOE,MAAP;AACD;KAnCqBrB,Q"},"metadata":{},"sourceType":"module"}