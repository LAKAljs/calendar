{"ast":null,"code":"export async function callForUser(accessToken) {\n  const headers = new Headers();\n  const bearer = `bearer ${accessToken}`;\n  headers.append(\"Authorization\", bearer);\n  const options = {\n    method: \"GET\",\n    headers: headers\n  };\n  const endpoint = \"https://graph.microsoft.com/v1.0/users?$orderby=displayName\";\n  return fetch(endpoint, options).then(response => response.json()).catch(error => console.log(error));\n}\nexport async function callForEvent(accessToken, user, displayName) {\n  const banned = ['bbd', 'chd', 'jet', 'bng', 'hed', 'hsp', 'hmj', 'epe', 'ezm', 'csc', 'bil', 'agr', 'ifh', 'bil1', 'ita', 'mlk'];\n  const headers = new Headers();\n  const bearer = `bearer ${accessToken}`;\n  headers.append(\"Authorization\", bearer);\n  const options = {\n    method: \"GET\",\n    headers: headers\n  };\n  const endpoint = `https://graph.microsoft.com/v1.0/users/${user}/events?$orderby=start/dateTime,end/dateTime%20asc&$filter=start/dateTime%20ge%20'2022-09-19T11:00'&$top=1`;\n\n  if (user.length > 12 || user.length < 11 || banned.includes(user.toLowerCase())) {\n    return 'The user is out of Scope ';\n  } else {\n    return fetch(endpoint, options).then(response => response.json()).catch(e => console.log(\"Der er ingen møder inden for denne tid!\"));\n  }\n}","map":{"version":3,"names":["callForUser","accessToken","headers","Headers","bearer","append","options","method","endpoint","fetch","then","response","json","catch","error","console","log","callForEvent","user","displayName","banned","length","includes","toLowerCase","e"],"sources":["/Users/lucassjostrommacbook/collected-calendar-build/src/components/DataCollection/GraphCalls.jsx"],"sourcesContent":["export async function callForUser(accessToken){\n\n    const headers = new Headers();\n    const bearer = `bearer ${accessToken}`;\n    headers.append(\"Authorization\", bearer);\n\n    const options = {\n        method: \"GET\",\n        headers: headers\n    };\n    const endpoint = \"https://graph.microsoft.com/v1.0/users?$orderby=displayName\";\n\n    return fetch(endpoint, options)\n        .then(response => response.json())\n        .catch(error => console.log(error))\n}\n\nexport async function callForEvent(accessToken, user, displayName){\n    const banned = ['bbd', 'chd', 'jet', 'bng', 'hed', 'hsp', 'hmj', 'epe', 'ezm', 'csc', 'bil', 'agr', 'ifh', 'bil1', 'ita', 'mlk'];\n    const headers = new Headers();\n    const bearer = `bearer ${accessToken}`;\n    headers.append(\"Authorization\", bearer);\n\n    const options = {\n        method: \"GET\",\n        headers: headers\n    };\n\n    const endpoint = `https://graph.microsoft.com/v1.0/users/${user}/events?$orderby=start/dateTime,end/dateTime%20asc&$filter=start/dateTime%20ge%20'2022-09-19T11:00'&$top=1`;\n\n    if(user.length > 12 || user.length < 11 || banned.includes(user.toLowerCase())){\n        return ('The user is out of Scope ')\n    } else {\n        return fetch(endpoint, options)\n        .then(response => response.json())\n        .catch((e) => console.log(\"Der er ingen møder inden for denne tid!\"))\n    }\n\n \n}"],"mappings":"AAAA,OAAO,eAAeA,WAAf,CAA2BC,WAA3B,EAAuC;EAE1C,MAAMC,OAAO,GAAG,IAAIC,OAAJ,EAAhB;EACA,MAAMC,MAAM,GAAI,UAASH,WAAY,EAArC;EACAC,OAAO,CAACG,MAAR,CAAe,eAAf,EAAgCD,MAAhC;EAEA,MAAME,OAAO,GAAG;IACZC,MAAM,EAAE,KADI;IAEZL,OAAO,EAAEA;EAFG,CAAhB;EAIA,MAAMM,QAAQ,GAAG,6DAAjB;EAEA,OAAOC,KAAK,CAACD,QAAD,EAAWF,OAAX,CAAL,CACFI,IADE,CACGC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADf,EAEFC,KAFE,CAEIC,KAAK,IAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAFb,CAAP;AAGH;AAED,OAAO,eAAeG,YAAf,CAA4BhB,WAA5B,EAAyCiB,IAAzC,EAA+CC,WAA/C,EAA2D;EAC9D,MAAMC,MAAM,GAAG,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,EAAsB,KAAtB,EAA6B,KAA7B,EAAoC,KAApC,EAA2C,KAA3C,EAAkD,KAAlD,EAAyD,KAAzD,EAAgE,KAAhE,EAAuE,KAAvE,EAA8E,KAA9E,EAAqF,KAArF,EAA4F,MAA5F,EAAoG,KAApG,EAA2G,KAA3G,CAAf;EACA,MAAMlB,OAAO,GAAG,IAAIC,OAAJ,EAAhB;EACA,MAAMC,MAAM,GAAI,UAASH,WAAY,EAArC;EACAC,OAAO,CAACG,MAAR,CAAe,eAAf,EAAgCD,MAAhC;EAEA,MAAME,OAAO,GAAG;IACZC,MAAM,EAAE,KADI;IAEZL,OAAO,EAAEA;EAFG,CAAhB;EAKA,MAAMM,QAAQ,GAAI,0CAAyCU,IAAK,4GAAhE;;EAEA,IAAGA,IAAI,CAACG,MAAL,GAAc,EAAd,IAAoBH,IAAI,CAACG,MAAL,GAAc,EAAlC,IAAwCD,MAAM,CAACE,QAAP,CAAgBJ,IAAI,CAACK,WAAL,EAAhB,CAA3C,EAA+E;IAC3E,OAAQ,2BAAR;EACH,CAFD,MAEO;IACH,OAAOd,KAAK,CAACD,QAAD,EAAWF,OAAX,CAAL,CACNI,IADM,CACDC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADX,EAENC,KAFM,CAECW,CAAD,IAAOT,OAAO,CAACC,GAAR,CAAY,yCAAZ,CAFP,CAAP;EAGH;AAGJ"},"metadata":{},"sourceType":"module"}