{"ast":null,"code":"export async function callForUser(accessToken) {\n  const headers = new Headers();\n  const bearer = `bearer ${accessToken}`;\n  headers.append(\"Authorization\", bearer);\n  const options = {\n    method: \"GET\",\n    headers: headers\n  };\n  const endpoint = \"https://graph.microsoft.com/v1.0/users?$orderby=displayName&$select=accountEnabled,start,end,displayName,userPrincipalName\";\n  return fetch(endpoint, options).then(response => response.json()).catch(error => console.log(error));\n}\nexport async function callForEvent(accessToken, user, accountEnabled) {\n  const headers = new Headers();\n  const bearer = `bearer ${accessToken}`;\n  headers.append(\"Authorization\", bearer);\n  const options = {\n    method: \"GET\",\n    headers: headers\n  };\n  const endpoint = `https://graph.microsoft.com/v1.0/users/${user}/events?$orderby=start/dateTime,end/dateTime%20asc&$filter=start/dateTime%20ge%20'2022-09-19T11:00'&$top=2`;\n\n  if (user.length > 12 || user.length < 11 || accountEnabled === false) {\n    return 'The user is out of Scope ';\n  } else {\n    return fetch(endpoint, options).then(response => {\n      if (response.ok) {\n        console.log('it returned successfully. V');\n        return response.json();\n      } else {\n        console.log('it did not return successfully!');\n        return false;\n      }\n    });\n  }\n}","map":{"version":3,"names":["callForUser","accessToken","headers","Headers","bearer","append","options","method","endpoint","fetch","then","response","json","catch","error","console","log","callForEvent","user","accountEnabled","length","ok"],"sources":["C:/Users/ljs/calendar/src/components/DataCollection/GraphCalls.jsx"],"sourcesContent":["export async function callForUser(accessToken){\r\n\r\n    const headers = new Headers();\r\n    const bearer = `bearer ${accessToken}`;\r\n    headers.append(\"Authorization\", bearer);\r\n\r\n    const options = {\r\n        method: \"GET\",\r\n        headers: headers\r\n    };\r\n    const endpoint = \"https://graph.microsoft.com/v1.0/users?$orderby=displayName&$select=accountEnabled,start,end,displayName,userPrincipalName\";\r\n\r\n    return fetch(endpoint, options)\r\n        .then(response => response.json())\r\n        .catch(error => console.log(error))\r\n}\r\n\r\nexport async function callForEvent(accessToken, user, accountEnabled){\r\n    const headers = new Headers();\r\n    const bearer = `bearer ${accessToken}`;\r\n    headers.append(\"Authorization\", bearer);\r\n\r\n    const options = {\r\n        method: \"GET\",\r\n        headers: headers\r\n    };\r\n\r\n    const endpoint = `https://graph.microsoft.com/v1.0/users/${user}/events?$orderby=start/dateTime,end/dateTime%20asc&$filter=start/dateTime%20ge%20'2022-09-19T11:00'&$top=2`;\r\n    if(user.length > 12 || user.length < 11 || accountEnabled === false){\r\n        return ('The user is out of Scope ');\r\n    } else {\r\n        return fetch(endpoint, options)\r\n        .then(response => {\r\n            if(response.ok){\r\n                console.log('it returned successfully. V');\r\n                return response.json();\r\n            } else {\r\n                console.log('it did not return successfully!');\r\n                return false;\r\n            }})\r\n    }\r\n        \r\n\r\n \r\n}"],"mappings":"AAAA,OAAO,eAAeA,WAAf,CAA2BC,WAA3B,EAAuC;EAE1C,MAAMC,OAAO,GAAG,IAAIC,OAAJ,EAAhB;EACA,MAAMC,MAAM,GAAI,UAASH,WAAY,EAArC;EACAC,OAAO,CAACG,MAAR,CAAe,eAAf,EAAgCD,MAAhC;EAEA,MAAME,OAAO,GAAG;IACZC,MAAM,EAAE,KADI;IAEZL,OAAO,EAAEA;EAFG,CAAhB;EAIA,MAAMM,QAAQ,GAAG,4HAAjB;EAEA,OAAOC,KAAK,CAACD,QAAD,EAAWF,OAAX,CAAL,CACFI,IADE,CACGC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADf,EAEFC,KAFE,CAEIC,KAAK,IAAIC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAFb,CAAP;AAGH;AAED,OAAO,eAAeG,YAAf,CAA4BhB,WAA5B,EAAyCiB,IAAzC,EAA+CC,cAA/C,EAA8D;EACjE,MAAMjB,OAAO,GAAG,IAAIC,OAAJ,EAAhB;EACA,MAAMC,MAAM,GAAI,UAASH,WAAY,EAArC;EACAC,OAAO,CAACG,MAAR,CAAe,eAAf,EAAgCD,MAAhC;EAEA,MAAME,OAAO,GAAG;IACZC,MAAM,EAAE,KADI;IAEZL,OAAO,EAAEA;EAFG,CAAhB;EAKA,MAAMM,QAAQ,GAAI,0CAAyCU,IAAK,4GAAhE;;EACA,IAAGA,IAAI,CAACE,MAAL,GAAc,EAAd,IAAoBF,IAAI,CAACE,MAAL,GAAc,EAAlC,IAAwCD,cAAc,KAAK,KAA9D,EAAoE;IAChE,OAAQ,2BAAR;EACH,CAFD,MAEO;IACH,OAAOV,KAAK,CAACD,QAAD,EAAWF,OAAX,CAAL,CACNI,IADM,CACDC,QAAQ,IAAI;MACd,IAAGA,QAAQ,CAACU,EAAZ,EAAe;QACXN,OAAO,CAACC,GAAR,CAAY,6BAAZ;QACA,OAAOL,QAAQ,CAACC,IAAT,EAAP;MACH,CAHD,MAGO;QACHG,OAAO,CAACC,GAAR,CAAY,iCAAZ;QACA,OAAO,KAAP;MACH;IAAC,CARC,CAAP;EASH;AAIJ"},"metadata":{},"sourceType":"module"}