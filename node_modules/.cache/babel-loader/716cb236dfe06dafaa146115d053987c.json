{"ast":null,"code":"var _jsxFileName = \"/Users/lucassjostrommacbook/collected-calendar-build/src/components/DataCollection/ReqUsers.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { useState, useEffect } from \"react\";\nimport { loginRequest } from '../../AuthenticationFolder/authConfig';\nimport Button from \"react-bootstrap/Button\";\nimport { callForUser, callForNextUser, callForEvent } from \"./GraphCalls\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction handleLogin(instance) {\n  //Handles login and catches exceptions\n  instance.loginRedirect(loginRequest).catch(e => {\n    console.error(e);\n  });\n}\n\nfunction handleLogout(instance) {\n  //Handles login and catches exceptions\n  instance.logoutRedirect().catch(e => {\n    console.error(e);\n  });\n}\n\nexport function GetUsers() {\n  _s();\n\n  const {\n    instance,\n    accounts\n  } = useMsal();\n  const [curUser, setCurUser] = useState(null);\n\n  function CallUser() {\n    const request = { ...loginRequest,\n      account: accounts[0]\n    };\n    instance.acquireTokenSilent(request).then(res => {\n      callForUser(res.accessToken).then(res => setCurUser(res));\n    }).catch(e => {\n      instance.acquireTokenPopup(request).then(res => {\n        callForUser(res.accessToken).then(res => getEvent(res));\n      });\n    });\n  }\n\n  useEffect(() => {\n    console.log(\"\" + curUser);\n  }, [getEvent]);\n\n  function getEvent(data) {\n    const request = { ...loginRequest,\n      account: accounts[0]\n    };\n    var arr = [];\n    data.map(user => {\n      const u = user.userPrincipalName;\n      instance.acquireTokenSilent(request).then(res => {\n        callForEvent(res.accessToken, u).then(res => {\n          const userMeet = [res.value[0].subject, user.displayName, res.value[0].startTime];\n          arr.push(userMeet);\n          console.log(arr);\n        }).catch(e => {\n          console.log(\"der skete en fejl!\");\n        });\n      });\n    });\n  }\n  /*\n            var u = user.value[0].userPrincipalName;\n          instance.acquireTokenSilent(request).then((res) => {\n              callForUser(res.accessToken, u).then((res) => console.log(res))\n          }).catch((e) =>{\n          instance.acquireTokenPopup(request).then((res) => {\n              callForUser(res.accessToken, u).then((res) => console.log(res))\n          })\n          })\n        //It checks for a authentication token, on the instance silently.\n      instance.acquireTokenSilent(request).then((response) => {\n          callForUser(response.accessToken).then(response => setUserList(response));\n      }).catch((e) => {\n          //If there is no token to be found, it will try to retrieve one in the background.\n          instance.acquireTokenPopup(request).then(response => {\n              callForUser(response.accessToken).then(response => setUserList(response))\n          })\n      }) */\n\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: CallUser()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 15\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 15\n    }, this)]\n  }, void 0, true);\n}\n\n_s(GetUsers, \"JEnqO+UtCmv3ikCEl+lX/HSmNus=\", false, function () {\n  return [useMsal];\n});\n\n_c = GetUsers;\nexport const ReqUsers = () => {\n  _s2();\n\n  //Bruger Msal (Microsfot Authentication Library.)\n  const {\n    instance\n  } = useMsal();\n  return (\n    /*#__PURE__*/\n    //Button class imported from react-boostrap\n    _jsxDEV(Button, {\n      className: \"ml-auto\",\n      onClick: () => handleLogin(instance),\n      children: \"Sign in using Redirect\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this)\n  );\n};\n\n_s2(ReqUsers, \"kNmaupTUyOO55c/HFAYpHUXUX7Y=\", false, function () {\n  return [useMsal];\n});\n\n_c2 = ReqUsers;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"GetUsers\");\n$RefreshReg$(_c2, \"ReqUsers\");","map":{"version":3,"names":["React","useMsal","useState","useEffect","loginRequest","Button","callForUser","callForNextUser","callForEvent","handleLogin","instance","loginRedirect","catch","e","console","error","handleLogout","logoutRedirect","GetUsers","accounts","curUser","setCurUser","CallUser","request","account","acquireTokenSilent","then","res","accessToken","acquireTokenPopup","getEvent","log","data","arr","map","user","u","userPrincipalName","userMeet","value","subject","displayName","startTime","push","ReqUsers"],"sources":["/Users/lucassjostrommacbook/collected-calendar-build/src/components/DataCollection/ReqUsers.jsx"],"sourcesContent":["import React from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { useState, useEffect } from \"react\"\nimport { loginRequest } from '../../AuthenticationFolder/authConfig'\nimport Button from \"react-bootstrap/Button\"\nimport { callForUser, callForNextUser, callForEvent } from \"./GraphCalls\"\n\nfunction handleLogin(instance) {\n    //Handles login and catches exceptions\n    instance.loginRedirect(loginRequest).catch(e => {\n        console.error(e);\n    });\n}\n\nfunction handleLogout(instance){\n    //Handles login and catches exceptions\n    instance.logoutRedirect().catch(e => {\n        console.error(e);\n    });\n}\n\nexport function GetUsers(){\n    const { instance, accounts } = useMsal();\n    const [curUser, setCurUser] = useState(null);\n\n    function CallUser(){\n        const request = {\n            ...loginRequest,\n            account: accounts[0]\n        };\n    \n        instance.acquireTokenSilent(request).then((res) => {\n            callForUser(res.accessToken).then((res) => setCurUser(res))\n        }).catch((e) =>{\n        instance.acquireTokenPopup(request).then((res) => {\n            callForUser(res.accessToken).then((res) => getEvent(res))\n        })\n        })\n    }\n\n    useEffect(() => {\n        console.log(\"\" + curUser)\n    }, [getEvent])\n\n    function getEvent(data){\n\n        const request = {\n            ...loginRequest,\n            account: accounts[0]\n        };\n\n        var arr = [];\n\n        data.map(user => {\n            const u = user.userPrincipalName;\n            instance.acquireTokenSilent(request).then((res) => {\n                callForEvent(res.accessToken, u).then((res) => {\n                    const userMeet = [res.value[0].subject, user.displayName, res.value[0].startTime]\n                    arr.push(userMeet);\n                    console.log(arr)\n\n                }).catch((e) => {\n                    console.log(\"der skete en fejl!\")\n                })\n            })\n        });\n    }\n\n    /*\n\n             var u = user.value[0].userPrincipalName;\n            instance.acquireTokenSilent(request).then((res) => {\n                callForUser(res.accessToken, u).then((res) => console.log(res))\n            }).catch((e) =>{\n            instance.acquireTokenPopup(request).then((res) => {\n                callForUser(res.accessToken, u).then((res) => console.log(res))\n            })\n            })\n\n\n        //It checks for a authentication token, on the instance silently.\n        instance.acquireTokenSilent(request).then((response) => {\n            callForUser(response.accessToken).then(response => setUserList(response));\n        }).catch((e) => {\n            //If there is no token to be found, it will try to retrieve one in the background.\n            instance.acquireTokenPopup(request).then(response => {\n                callForUser(response.accessToken).then(response => setUserList(response))\n            })\n        }) */\n\n        return(\n            <>\n              <button onClick={CallUser()}></button>\n              <h2></h2>\n            </>\n        )\n}\n\n\n\n\n\nexport const ReqUsers = () => {\n    //Bruger Msal (Microsfot Authentication Library.)\n    const { instance } = useMsal();\n    return (\n        //Button class imported from react-boostrap\n        <Button className=\"ml-auto\" onClick={() => handleLogin(instance)}>Sign in using Redirect</Button>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}